{% extends '_layouts/base_portal.html' %}
{% load staticfiles %}

{% block title %} Users {% endblock title %}

{% block css %}
<link rel="stylesheet" href="{% static 'plugins/datatables/dataTables.bootstrap.css' %}">
{% endblock css %}

{% block header %}Users{% endblock header %}

{% block content %}
<section class="content">
  <div class="row">
    <div class="col-xs-12">
        <div class="box">

            <div class="box-body">
              {% include "_includes/table_header.html" with tableID="userTable" header_class="basic-teal" header=table_headers %}            
                <tbody>
                    {% for buyer in buyers %}           
                    <tr>
                      <td>{{ buyer.user.username }}</td>
                      <td>{{ buyer.user.email }}</td>                      
                      <td>{{ buyer.role }}</td> 
                      <td>{% if buyer.user.is_active %} 
                          <span class="label label-success"> Active </span>
                          {% else %} 
                          <span class="label label-warning"> Pending </span>
                          {% endif %}
                      </td> 
                      <td>
                        <form method="POST">
                          {% csrf_token %}
                          {% if user.buyer_profile.role == 'SuperUser' and buyer.role != 'SuperUser' %}
                            <button type="submit" name="delete" value="{{buyer.id}}"><i class="fa fa-trash"></i></button>
                          {% endif %}
                        </form>
                      </td>
                    </tr>
                    {% endfor %}
                </tbody>
              </table>
            <br>

            <button type="button" class="btn basic-teal pull-right" data-toggle="modal" data-target="#addModal">Add User</button>  
            {% include "_includes/modal_multiform.html" with target="User" form1=user_form  form2=buyer_profile_form %}            
            
            </div>

          </div>
        </div>
    </div>
</section>
{% endblock content %}

{% block js %}
  {% include "_includes/dataTablesNotifications.html" with tableID="userTable" %}
{% endblock js %}  
