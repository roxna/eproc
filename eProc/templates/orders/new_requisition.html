{% extends '_layouts/base_portal.html' %}
{% load staticfiles %}

{% block title %}New Requisition{% endblock title %}

{% block css %}
<link rel="stylesheet" href="{% static 'plugins/datepicker/datepicker3.css' %}">
{% endblock css %}

{% block header %}Request an Order <small></small>{% endblock header %}

{% block content %}
<section class="content">

	{% if messages %}
	    {% for message in messages %}
	        <p>{{ message }}</p>
	    {% endfor %}
	{% endif %}

    <form method="POST" action="new_requisition">
	{% csrf_token %}

      <div class="box box-default">

	    <!-- DEPARTMENT & NEXT APPROVER DROPDOWNS -->
        <div class="box-header with-border">
          <h3 class="box-title">Order Details</h3>
        </div>       

         <div class="box-body">
          <div class="row">
        	<div class="col-xs-12">
				<div class="box-body table-responsive no-padding">
	              <table class="table table-striped">
	                <tr>	                  
	                  <th>Number</th>
	                  <th>Department</th>
	                  <th>Date required</th>	                  
	                  <th>Comments</th>
	                </tr>
    				<tr>    					
    					<td>{{ requisition_form.number }}</td>
    					<td>{{ requisition_form.department }}</td>
    					<td>{{ requisition_form.date_due }}</td>    					
    					<td>{{ requisition_form.comments }}</td>
    				</tr>
    			   </table>
	            </div>
	        </div>
		</div>  <br> 

        <!-- ORDER DETAILS -->
        <div class="box-header with-border">
          <h3 class="box-title">Order Items List</h3>
        </div>

        <div class="box-body">
          <div class="row">
        	<div class="col-xs-12">
				<div class="box-body table-responsive no-padding">
	              <table class="table">
	                <tr class="basic">
	                  <th class="col-xs-4">Product</th>
	                  <th class="col-xs-4">Details/Comments</th>
	                  <th class="col-xs-3">Account Code</th>
	                  <th class="col-xs-1">Quantity</th>	                  
	                </tr>

		        	{{ orderitem_formset.management_form }}
		        	{% for orderitem_form in orderitem_formset %}    				
    				<tr class="orderitem_formset">
    					<td>{{ orderitem_form.product }}</td>
    					<td>{{ orderitem_form.comments }}</td>
    					<td>{{ orderitem_form.account_code }}</td>
    					<td>{{ orderitem_form.quantity }}</td>    					
    				</tr>
    				{% endfor %}
    				</table>
	            </div>
	        </div>
		</div>
        
        <div class="pull-right">Next Approver: {{ requisition_form.next_approver }} </div><br><br>
        <!-- Create New Requisition Button -->

    	<input type="submit" value="SUBMIT REQUEST" class="button basic pull-right"/>

    </form>

</section>
{% endblock content %}


{% block js %}
<script src="{% static 'plugins/datepicker/bootstrap-datepicker.js' %}"></script>
<script src="{% static 'plugins/django-dynamic-formset/jquery.formset.js' %}"></script>
<script type="text/javascript">
    $('.orderitem_formset').formset({
        addText: '<i class="fa fa-plus"></i> Add Line Item',
        deleteText: ' <span class="pull-right"><i class="fa fa-trash"></i></span>'
    });
</script>
{% endblock js %}









